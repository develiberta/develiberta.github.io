<!DOCTYPE html><html lang="en" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="OS Synchronization Tools" /><meta name="author" content="Develiberta" /><meta property="og:locale" content="en" /><meta name="description" content="목적 협력적 프로세스가 동시에 데이터에 접근할 때 발생하는 문제를 이해한다. 임계구역 문제에 대한 하드웨어 해결책과 소프트웨어 해결책을 이해한다." /><meta property="og:description" content="목적 협력적 프로세스가 동시에 데이터에 접근할 때 발생하는 문제를 이해한다. 임계구역 문제에 대한 하드웨어 해결책과 소프트웨어 해결책을 이해한다." /><link rel="canonical" href="https://develiberta.github.io/posts/os-synchronization-tools/" /><meta property="og:url" content="https://develiberta.github.io/posts/os-synchronization-tools/" /><meta property="og:site_name" content="Develiberta" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-11-12T13:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="OS Synchronization Tools" /><meta name="twitter:site" content="@develiberta" /><meta name="twitter:creator" content="@Develiberta" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Develiberta"},"dateModified":"2022-12-18T22:42:31+09:00","datePublished":"2022-11-12T13:00:00+09:00","description":"목적 협력적 프로세스가 동시에 데이터에 접근할 때 발생하는 문제를 이해한다. 임계구역 문제에 대한 하드웨어 해결책과 소프트웨어 해결책을 이해한다.","headline":"OS Synchronization Tools","mainEntityOfPage":{"@type":"WebPage","@id":"https://develiberta.github.io/posts/os-synchronization-tools/"},"url":"https://develiberta.github.io/posts/os-synchronization-tools/"}</script><title>OS Synchronization Tools | Develiberta</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png?v=1743601323"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png?v=1743601323"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png?v=1743601323"><link rel="manifest" href="/assets/img/favicons/site.webmanifest?v=1743601323"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico?v=1743601323"><meta name="apple-mobile-web-app-title" content="Develiberta"><meta name="application-name" content="Develiberta"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css?v=1743601323"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css?v=1743601323"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/?v=1743601323" alt="avatar" class="mx-auto"> <img src="/assets/img/favicons/android-chrome-512x512.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/?v=1743601323">Develiberta</a></div><div class="site-subtitle font-italic"></div></div><ul class="w-100"><li class="nav-item"> <a href="/?v=1743601323" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/?v=1743601323" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/?v=1743601323" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/?v=1743601323" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/?v=1743601323" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/develiberta?v=1743601323" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/develiberta?v=1743601323" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['develiberta','gmail.com'].join('@')?v=1743601323" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml?v=1743601323" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/?v=1743601323"> Home </a> </span> <span>OS Synchronization Tools</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>OS Synchronization Tools</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Develiberta </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Nov 12, 2022, 1:00 PM +0900" >Nov 12, 2022<i class="unloaded">2022-11-12T13:00:00+09:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Dec 18, 2022, 10:42 PM +0900" >Dec 18, 2022<i class="unloaded">2022-12-18T22:42:31+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3287 words">18 min read</span></div></div><div class="post-content"><h2 id="목적">목적</h2><hr /><ol><li>협력적 프로세스가 동시에 데이터에 접근할 때 발생하는 문제를 이해한다.<li>임계구역 문제에 대한 하드웨어 해결책과 소프트웨어 해결책을 이해한다.</ol><h2 id="실천-목표">실천 목표</h2><hr /><ol><li>임계구역 문제를 설명하고 경쟁 조건(Race Condition)을 설명한다.<li>메모리 장벽, compare-and-swap 연산 및 원자적 변수를 사용하여 임계구역 문제에 대한 하드웨어 해결책을 설명한다.<li>Mutex 락, 세마포어, 모니터 및 조건 변수를 사용하여 임계구역 문제를 해결하는 방법을 보인다.<li>적은, 중간 및 심한 경쟁 시나리오에서 임계구역 문제를 해결하는 도구를 평가한다.</ol><h2 id="기본적인-개념-정리">기본적인 개념 정리</h2><hr /><ol><li>경쟁 조건 (Race Condition)<ul><li>다음 두 조건을 만족하는 특정한 상황<ol><li>동시에 여러 개의 프로세스가 동일한 자료를 접근하여 조작<li>접근이 발생한 특정 순서에 따라 실행 결과가 달라짐</ol></ul><li>데이터 무결성 (Data Integrity)<ul><li>접근이 발생한 특정 순서에 따라 실행 결과가 달라지는 것은 문맥 교환이 명령(코드)의 논리적 최소 단위 내부에서 발생해서 데이터 무결성이 손상되었기 때문<li>(예) count++<ol><li>register1 = count (LOAD R1, #count)<li>register1 = register1 + 1 (ADD R1, $1)<li>count = register1 (STORE #count, R1)</ol><li>위에서 2와 3 사이에 문맥 교환이 발생하는 경우 문제가 발생<li>LOAD된 공유 데이터에 대해 처리하는 부분에서 멈춘 상태에서 다른 프로세스가 LOAD된 데이터를 변경하는 상황이 되고<li>다시 이 프로세스가 문맥을 받으면 처리를 재개한 후에 해당 처리 결과를 다시 공유 데이터에 STORE하므로<li>다른 프로세스가 데이터를 변경한 내용에 대해서는 반영이 되지 않고 해당 명령은 실행되지 않은 것과 마찬가지가 됨</ul><li>동기화 (Process Synchoronization)<ul><li>데이터 무결성을 지키는 이론적인 방법<li>넓은 의미 : 동기화는 시스템을 동시에 작동시키기 위해 여러 사건들을 조화시키는 것<li>여기에서 동기화란, 여러 프로세스가 공유 데이터에 대해 일관된 데이터를 바탕으로 명령을 수행할 수 있도록<li>데이터를 일치시킨다는 의미</ul><li>임계 구역 (Critical Section)<ul><li>여러 프로세스에게 공유된 데이터에 대해 여러 프로세스가 이를 접근/수정하는 영역(코드 조각)</ul><li>임계 구역 문제 (Critical Section Problem)<ul><li>프로세스들이 공유 데이터와 관련된 수행을 동기화하기 위해 사용하는 상호간 규약을 설계하는 것</ul></ol><h2 id="임계-구역-문제의-해결안-세-가지-조건">임계 구역 문제의 해결안, 세 가지 조건</h2><hr /><ol><li>상호 배제 (Mutual Exclusion) ★ 반드시 만족해야 하는 조건<ul><li>프로세스가 자기의 임계 구역에서 실행된다면 다른 프로세스들은 그들 자신의 임계 구역에서 실행될 수 없음</ul><li>진행 (Progress)<ul><li>데드락 (Deadlock)을 피하기 위함<li>자신의 임계 구역에서 실행되는 프로세스가 없고, 그들 자신의 임계구역으로 진입하고자 하는 프로세스들이 있다면<li>그 프로세스들의 진입은 무한정 연기될 수 없음</ul><li>한정된 대기 (Bounded Waiting)<ul><li>기아 현상 (Starvation)을 피하기 위함<li>프로세스가 자신의 임계 구역에 진입하려는 요청을 한 후부터 그 요청이 허용될 때까지<li>다른 프로세스들이 그들 자신의 임계 구역이 진입하도록 허용되는 횟수에 한계가 있음</ul></ol><h2 id="임계-구역-문제-해결책">임계 구역 문제 해결책</h2><hr /><ol><li>소프트웨어 기반 해결책<ol><li>피터슨 해결책 (Peterson’s Solution)</ol><li>하드웨어 기반 해결책<ol><li>메모리 장벽 (Memory Barriers)<li>하드웨어 명령어 (Hardware Instructions)<li>원자적 변수 (Atomic Variables)</ol></ol><h2 id="소프트웨어-기반-해결책---피터슨-해결책-petersons-solution">소프트웨어 기반 해결책 - 피터슨 해결책 (Peterson’s Solution)</h2><hr /><ul><li>임계 구역 문제를 가장 완전하게 해결한 알고리즘<li>상호 배제, 진행, 한정된 대기 조건을 모두 만족함을 증명 가능<li>그러나 소프트웨어 명령어가 하드웨어 상에서는 여러 개로 쪼개어져 실행되므로 (예) LOAD, STORE<li>실제 실행해보면 임계 구역 문제가 해결되지 않은 결과 출력<div lang="c" class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
</pre><td class="rouge-code"><pre>  <span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span>  <span class="cp">#include</span> <span class="cpf">&lt;pthread.h&gt;</span><span class="cp">
</span>
  <span class="cp">#define true 1
</span>  <span class="cp">#define false 0
</span>
  <span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="kt">int</span> <span class="n">turn</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">flag</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>

  <span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
  <span class="p">{</span>
      <span class="n">pthread_t</span> <span class="n">tid1</span><span class="p">,</span> <span class="n">tid2</span><span class="p">;</span>
      <span class="n">pthread_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tid1</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">producer</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
      <span class="n">pthread_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tid2</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">consumer</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
      <span class="n">pthread_join</span><span class="p">(</span><span class="n">tid1</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
      <span class="n">pthread_join</span><span class="p">(</span><span class="n">tid2</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">"sum = %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">sum</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kt">void</span> <span class="o">*</span><span class="nf">producer</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">param</span><span class="p">)</span>
  <span class="p">{</span>
      <span class="kt">int</span> <span class="n">k</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="cm">/* entry section */</span>
          <span class="n">flag</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
          <span class="n">turn</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
          <span class="k">while</span> <span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">turn</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
              <span class="p">;</span>
			
          <span class="cm">/* critical section */</span>
          <span class="n">sum</span><span class="o">++</span><span class="p">;</span>

          <span class="cm">/* exit section */</span>
          <span class="n">flag</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

          <span class="cm">/* remainder section */</span>
      <span class="p">}</span>
      <span class="n">pthread_exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kt">void</span> <span class="o">*</span><span class="nf">consumer</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">param</span><span class="p">)</span>
  <span class="p">{</span>
      <span class="kt">int</span> <span class="n">k</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="cm">/* entry section */</span>
          <span class="n">flag</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
          <span class="n">turn</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="k">while</span> <span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">turn</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
              <span class="p">;</span>
			
          <span class="cm">/* critical section */</span>
          <span class="n">sum</span><span class="o">--</span><span class="p">;</span>

          <span class="cm">/* exit section */</span>
          <span class="n">flag</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

          <span class="cm">/* remainder section */</span>
      <span class="p">}</span>
      <span class="n">pthread_exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>	
</pre></table></code></div></div></ul><h2 id="하드웨어-기반-해결책---원자적-변수-atomic-variables">하드웨어 기반 해결책 - 원자적 변수 (Atomic Variables)</h2><hr /><ul><li>하드웨어의 지원이 바탕이 되는 해결책<li>LOAD와 STORE하는 부분에 대해 문맥 교환이 발생하지 않도록 통합한 하나의 하드웨어 명령어를 이용해서<li>기본적인 데이터 타입에 대해 쪼개어질 수 없는 연산이 정의된<li>하나의 변수로,<li>경쟁 조건 (Race Condition) 상황에서의 상호 배제를 확실하게 보장하게 위해 사용<div lang="java" class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
</pre><td class="rouge-code"><pre>  <span class="kn">package</span> <span class="nn">os.concepts</span><span class="o">;</span>

  <span class="kn">import</span> <span class="nn">java.util.concurrent.atomic.AtomicBoolean</span><span class="o">;</span>

  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Peterson2</span> <span class="o">{</span>

      <span class="kd">static</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

      <span class="kd">static</span> <span class="kt">int</span> <span class="n">turn</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
      <span class="kd">static</span> <span class="nc">AtomicBoolean</span><span class="o">[]</span> <span class="n">flag</span><span class="o">;</span>    <span class="c1">// static boolean[] flag = new boolean[2];</span>
      <span class="kd">static</span> <span class="o">{</span>
          <span class="n">flag</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AtomicBoolean</span><span class="o">[</span><span class="mi">2</span><span class="o">];</span>
          <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">flag</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
              <span class="n">flag</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AtomicBoolean</span><span class="o">();</span>
          <span class="o">}</span>
      <span class="o">}</span>

      <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
          <span class="nc">Thread</span> <span class="n">t1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Thread</span><span class="o">(</span><span class="k">new</span> <span class="nc">Producer</span><span class="o">());</span>
          <span class="nc">Thread</span> <span class="n">t2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Thread</span><span class="o">(</span><span class="k">new</span> <span class="nc">Consumer</span><span class="o">());</span>
          <span class="n">t1</span><span class="o">.</span><span class="na">start</span><span class="o">();</span> <span class="n">t2</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
          <span class="n">t1</span><span class="o">.</span><span class="na">join</span><span class="o">();</span> <span class="n">t2</span><span class="o">.</span><span class="na">join</span><span class="o">();</span>
          <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">Peterson2</span><span class="o">.</span><span class="na">count</span><span class="o">);</span>
      <span class="o">}</span>

      <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Producer</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>
          <span class="nd">@Override</span>
          <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
              <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">100000</span><span class="o">;</span> <span class="n">k</span><span class="o">++)</span> <span class="o">{</span>
                  <span class="cm">/* entry section */</span>
                  <span class="n">flag</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">set</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>  <span class="c1">// flag[0] = true;</span>
                  <span class="n">turn</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
                  <span class="k">while</span> <span class="o">(</span><span class="n">flag</span><span class="o">[</span><span class="mi">1</span><span class="o">].</span><span class="na">get</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="n">turn</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span>  <span class="c1">// while (flag[1] &amp;&amp; turn == 1)</span>
                      <span class="o">;</span>

                  <span class="cm">/* critical section */</span>
                  <span class="n">count</span><span class="o">++;</span>

                  <span class="cm">/* exit section */</span>
                  <span class="n">flag</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">set</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span> <span class="c1">// flag[0] = false;</span>

                  <span class="cm">/* remainder section */</span>
              <span class="o">}</span>
          <span class="o">}</span>
      <span class="o">}</span>

      <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Consumer</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>
          <span class="nd">@Override</span>
          <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
              <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">100000</span><span class="o">;</span> <span class="n">k</span><span class="o">++)</span> <span class="o">{</span>
                  <span class="cm">/* entry section */</span>
                  <span class="n">flag</span><span class="o">[</span><span class="mi">1</span><span class="o">].</span><span class="na">set</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>  <span class="c1">// flag[1] = true;</span>
                  <span class="n">turn</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
                  <span class="k">while</span> <span class="o">(</span><span class="n">flag</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">get</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="n">turn</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>  <span class="c1">// while (flag[0] &amp;&amp; turn == 0)</span>
                      <span class="o">;</span>

                  <span class="cm">/* critical section */</span>
                  <span class="n">count</span><span class="o">--;</span>

                  <span class="cm">/* exit section */</span>
                  <span class="n">flag</span><span class="o">[</span><span class="mi">1</span><span class="o">].</span><span class="na">set</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span> <span class="c1">// flag[1] = false;</span>

                  <span class="cm">/* remainder section */</span>
              <span class="o">}</span>
          <span class="o">}</span>
      <span class="o">}</span>

  <span class="o">}</span>
</pre></table></code></div></div></ul><h2 id="임계-구역-문제-조건-중-상호-배제만-해결하는-해결책-소프트웨어적으로-운영체제나-프로그래밍-언어가-제공">임계 구역 문제 조건 중 ‘상호 배제’만 해결하는 해결책 (소프트웨어적으로 운영체제나 프로그래밍 언어가 제공)</h2><hr /><ol><li>뮤텍스<li>세마포어<li>모니터</ol><h2 id="뮤텍스">뮤텍스</h2><hr /><ul><li>mutual exclusion<li>임계 구역을 보호해서 경쟁 조건을 방지하기 위해서 lock(열쇠의 비유)을 이용하는 방법<li>프로세스가<li>critical section에 진입하기 전에 lock(열쇠의 비유)을 얻고 acquire()<li>critical section을 마치면서 lock(열쇠의 비유)을 다시 놓아주는 release() 방법<li>lock(열쇠의 비유)이 사용 가능한지 여부를 담는 available 변수 사용<div lang="java" class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>  <span class="n">acquire</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">while</span> <span class="o">(!</span><span class="n">available</span><span class="o">)</span>
          <span class="o">;</span> <span class="cm">/* busy wait */</span>
      <span class="n">available</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="n">release</span><span class="o">()</span> <span class="o">{</span>
      <span class="n">available</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
  <span class="o">}</span>
</pre></table></code></div></div><li>이때 acquire()와 release()는 atomically 원자적으로 수행되어야 함 (하드웨어적 지원을 이용)<li>위의 코드에서 프로세스가 critical section에 진입하기 위해 busy waiting이 발생하는데, 이는 1개의 CPU 코어를 여러 프로세스가 공유하는 멀티프로그래밍 시스템에서는 CPU 사이클을 낭비하여 문제가 됨<li>그러나 CPU 코어가 여러 개인 경우 문맥 교환이 일어나지 않아서 문맥 교환에 사용되는 시간을 절약 가능 (이때는 busy waiting을 spinlock이라고 명명)<div lang="c" class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>  <span class="kt">void</span> <span class="o">*</span><span class="nf">counter</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">param</span><span class="p">)</span>
  <span class="p">{</span>
      <span class="kt">int</span> <span class="n">k</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="cm">/* entry section */</span>
          <span class="n">pthread_mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex</span><span class="p">);</span>

          <span class="cm">/* critical section */</span>
          <span class="n">sum</span><span class="o">++</span><span class="p">;</span>

          <span class="cm">/* exit section */</span>
          <span class="n">pthread_mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="n">pthread_exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>
</pre></table></code></div></div><div lang="c" class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>  <span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span>  <span class="cp">#include</span> <span class="cpf">&lt;pthread.h&gt;</span><span class="cp">
</span>
  <span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="c1">// a shared variable</span>

  <span class="n">pthread_mutex_t</span> <span class="n">mutex</span><span class="p">;</span>

  <span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
  <span class="p">{</span>
      <span class="n">pthread_t</span> <span class="n">tid1</span><span class="p">,</span> <span class="n">tid2</span><span class="p">;</span>
      <span class="n">pthread_mutex_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">mutex</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
      <span class="n">pthread_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tid1</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">counter</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
      <span class="n">pthread_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tid2</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">counter</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
      <span class="n">pthread_join</span><span class="p">(</span><span class="n">tid1</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
      <span class="n">pthread_join</span><span class="p">(</span><span class="n">tid2</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">"sum = %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">sum</span><span class="p">);</span>
  <span class="p">}</span>
</pre></table></code></div></div></ul><h2 id="세마포어">세마포어</h2><hr /><ul><li>세마포어 S는 사용자의 상황에 맞게 초기화 가능한 정수형 변수로,<li>오직 두 개의 표준적이고 원자적인 수행에 의해서 접근될 수 있는데,<li>이는 wait()와 signal() (또는 P()와 V())<li>mutex가 열쇠가 하나였다면 세마포어는 열쇠가 한 개(Binary Semaphore) 또는 여러 개(Counting Semaphore)인 것으로, 이 열쇠의 개수가 S의 값<div lang="java" class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>  <span class="n">wait</span><span class="o">(</span><span class="no">S</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">while</span> <span class="o">(</span><span class="no">S</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="o">)</span>
          <span class="o">;</span> <span class="cm">/* busy wait */</span>
      <span class="no">S</span><span class="o">--;</span>
  <span class="o">}</span>

  <span class="n">signal</span><span class="o">()</span> <span class="o">{</span>
      <span class="no">S</span><span class="o">++;</span>
  <span class="o">}</span>
</pre></table></code></div></div><li>이때 wait()와 signal()는 atomically 원자적으로 수행되어야 함 (하드웨어적 지원을 이용)<li>S = 0 인 경우는 모든 리소스가 사용중인 상태를 의미<li>프로세스 P1의 Statement S1과 프로세스 P2의 Statement S2에 대해서 S1이 끝난 이후에 S2가 실행되어야 한다면 S = 0으로 초기화 후 다음과 같이 수행 가능<div lang="c" class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>  <span class="n">S1</span><span class="p">;</span>
  <span class="n">signal</span><span class="p">(</span><span class="n">S</span><span class="p">);</span>	<span class="c1">// S++ 해서 S가 1이 됨</span>
</pre></table></code></div></div><div lang="c" class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>  <span class="n">wait</span><span class="p">(</span><span class="n">S</span><span class="p">);</span>	<span class="c1">// S가 0인 상태 - 위의 수행으로 S가 1이 되면 아래 명령이 실행됨</span>
  <span class="n">S2</span><span class="p">;</span>
</pre></table></code></div></div><li>위에서 설명한 세마포어도 뮤텍스와 마찬가지로 busy waiting 문제를 가지고 있으므로 이를 해결하기 위해 대기큐를 이용할 수 있음 (모두 커널 레벨에서 구현하는 것)<div lang="c" class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>  <span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
      <span class="kt">int</span> <span class="n">value</span><span class="p">;</span>	<span class="c1">// 세마포어 값 S</span>
      <span class="k">struct</span> <span class="n">process</span> <span class="o">*</span><span class="n">list</span><span class="p">;</span>
  <span class="p">}</span> <span class="n">semaphore</span><span class="p">;</span>	<span class="c1">// 세마포어 S에 대해 대기하고 있는 프로세스 리스트</span>

  <span class="n">wait</span><span class="p">(</span><span class="n">semaphore</span> <span class="o">*</span><span class="n">S</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">S</span><span class="o">-&gt;</span><span class="n">value</span><span class="o">--</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">S</span><span class="o">-&gt;</span><span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">add</span> <span class="n">this</span> <span class="n">process</span> <span class="n">to</span> <span class="n">S</span><span class="o">-&gt;</span><span class="n">list</span><span class="p">;</span>
          <span class="n">sleep</span><span class="p">();</span>
      <span class="p">}</span>
  <span class="p">}</span>

  <span class="n">signal</span><span class="p">(</span><span class="n">semaphore</span> <span class="o">*</span><span class="n">S</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">S</span><span class="o">-&gt;</span><span class="n">value</span><span class="o">++</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">S</span><span class="o">-&gt;</span><span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">remove</span> <span class="n">a</span> <span class="n">process</span> <span class="n">P</span> <span class="n">from</span> <span class="n">S</span><span class="o">-&gt;</span><span class="n">list</span><span class="p">;</span>
          <span class="n">wakeup</span><span class="p">(</span><span class="n">P</span><span class="p">);</span>
      <span class="p">}</span>
  <span class="p">}</span>
</pre></table></code></div></div><div lang="c" class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>  <span class="kt">void</span> <span class="o">*</span><span class="nf">counter</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">param</span><span class="p">)</span> <span class="p">{</span>
      <span class="kt">int</span> <span class="n">k</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="cm">/* entry section */</span>
          <span class="n">sem_wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sem</span><span class="p">);</span>

          <span class="cm">/* critical section */</span>
          <span class="n">sum</span><span class="o">++</span><span class="p">;</span>

          <span class="cm">/* exit section */</span>
          <span class="n">sem_post</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sem</span><span class="p">);</span>

          <span class="cm">/* remainder section */</span>
  <span class="p">}</span>
  <span class="n">pthread_exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</pre></table></code></div></div><div lang="c" class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>  <span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span>  <span class="cp">#include</span> <span class="cpf">&lt;pthread.h&gt;</span><span class="cp">
</span>  <span class="cp">#include</span> <span class="cpf">&lt;semaphore.h&gt;</span><span class="cp">
</span>
  <span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// a shared variable</span>

  <span class="n">sem_t</span> <span class="n">sem</span><span class="p">;</span> <span class="c1">// 세마포어 타입</span>

  <span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
  <span class="p">{</span>
      <span class="n">pthread_t</span> <span class="n">tid1</span><span class="p">,</span> <span class="n">tid2</span><span class="p">;</span>
      <span class="n">sem_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sem</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// 열쇠인 S가 총 1개</span>
      <span class="n">pthread_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tid1</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">counter</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
      <span class="n">pthread_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tid2</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">counter</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
      <span class="n">pthread_join</span><span class="p">(</span><span class="n">tid1</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
      <span class="n">pthread_join</span><span class="p">(</span><span class="n">tid2</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">"sum = %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">sum</span><span class="p">);</span>
  <span class="p">}</span>
</pre></table></code></div></div></ul><h2 id="모니터">모니터</h2><hr /><ul><li>뮤텍스와 세마포어가 편리하고 효과적이지만 timing errors(programming errors에 속함) 발생 가능<li>이를 방지하기 위해서 높은 레벨로 동기화에 대한 구성을 갖춰놓은 monitor 도구 사용 가능<li>monitor은 프로그래밍 적으로 정의된 명령어의 집합으로 일종의 추상 데이터 형태 (클래스와 비슷)<div lang="c" class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>  <span class="n">monitor</span> <span class="n">monitor_name</span>
  <span class="p">{</span>
      <span class="cm">/* shared variable declarations */</span>
      <span class="n">function</span> <span class="n">P1</span> <span class="p">(</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">)</span> <span class="p">{</span>
          <span class="cm">/* ... */</span>
      <span class="p">}</span>
      <span class="n">function</span> <span class="n">P2</span> <span class="p">(</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">)</span> <span class="p">{</span>
          <span class="cm">/* ... */</span>
      <span class="p">}</span>
      <span class="cm">/* ... */</span>
      <span class="n">function</span> <span class="n">PN</span> <span class="p">(</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">)</span> <span class="p">{</span>
          <span class="cm">/* ... */</span>
      <span class="p">}</span>
      <span class="n">initialization_code</span> <span class="p">(</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">)</span> <span class="p">{</span>
          <span class="cm">/* ... */</span>
      <span class="p">}</span>
  <span class="p">}</span>
</pre></table></code></div></div><li>위의 모니터 구조물이 충분하지 않으므로 부가적인 동기화 기법 정의<div lang="java" class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>  <span class="n">monitor</span> <span class="n">monitor_name</span>
  <span class="o">{</span>
      <span class="n">conditional</span> <span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">;</span>
      <span class="n">x</span><span class="o">.</span><span class="na">wait</span><span class="o">();</span>
      <span class="n">x</span><span class="o">.</span><span class="na">notify</span><span class="o">();</span>
  <span class="o">}</span>
</pre></table></code></div></div><li>더 간편하게는 java의 synchronized 키워드 사용<div lang="java" class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre>  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">SynchExample4</span> <span class="o">{</span>
      <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Counter</span> <span class="o">{</span>
          <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
          <span class="kd">public</span> <span class="kt">void</span> <span class="nf">increment</span><span class="o">()</span> <span class="o">{</span>
              <span class="kd">synchronized</span> <span class="o">(</span><span class="k">this</span><span class="o">)</span> <span class="o">{</span>
                  <span class="nc">Counter</span><span class="o">.</span><span class="na">count</span><span class="o">++;</span>
              <span class="o">}</span>
          <span class="o">}</span>
      <span class="o">}</span>
  <span class="o">}</span>

  <span class="kd">static</span> <span class="kd">class</span> <span class="nc">MyRunnable</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>
      <span class="nc">Counter</span> <span class="n">counter</span><span class="o">;</span>
      <span class="kd">public</span> <span class="nf">MyRunnable</span><span class="o">(</span><span class="nc">Counter</span> <span class="n">counter</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">this</span><span class="o">.</span><span class="na">counter</span> <span class="o">=</span> <span class="n">counter</span><span class="o">;</span>
      <span class="o">}</span>

      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
          <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
              <span class="n">counter</span><span class="o">.</span><span class="na">increment</span><span class="o">();</span>
          <span class="o">}</span>
      <span class="o">}</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
      <span class="nc">Thread</span><span class="o">[]</span> <span class="n">threads</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Thread</span><span class="o">[</span><span class="mi">5</span><span class="o">];</span>
      <span class="nc">Counter</span> <span class="n">counter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Counter</span><span class="o">();</span>
      <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span><span class="mi">0</span> <span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">threads</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
          <span class="n">threads</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Thread</span><span class="o">(</span><span class="k">new</span> <span class="nc">Runnable</span><span class="o">(</span><span class="n">counter</span><span class="o">));</span>
          <span class="n">threads</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">start</span><span class="o">();</span>
      <span class="o">}</span>
      <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">threads</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
          <span class="n">threads</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">join</span><span class="o">();</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">pripntln</span><span class="o">(</span><span class="s">"counter = "</span> <span class="o">+</span> <span class="nc">Counter</span><span class="o">.</span><span class="na">count</span><span class="o">);</span>
  <span class="o">}</span>
</pre></table></code></div></div></ul><h2 id="참고">참고</h2><hr /><ol><li>운영체제 공룡책 강의 | 주니온 | 인프런 https://www.inflearn.com/course/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EA%B3%B5%EB%A3%A1%EC%B1%85-%EC%A0%84%EA%B3%B5%EA%B0%95%EC%9D%98/dashboard<li><div class="table-wrapper"><table><tbody><tr><td>운영체제 제 10판<td>Abraham Silberschatz, Peter Baer Galvin, Greg Gagne 저/박민규 역<td>퍼스트북<td>2020년 02월 28일</table></div><li>운영체제 제 10판 솔루션 https://codex.cs.yale.edu/avi/os-book/OS10/practice-exercises/index-solu.html</ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/cs/'>CS</a>, <a href='/categories/os/'>OS</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/cs/" class="post-tag no-text-decoration" >CS</a> <a href="/tags/os/" class="post-tag no-text-decoration" >OS</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/?v=1743601323"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=OS Synchronization Tools - Develiberta&url=https://develiberta.github.io/posts/os-synchronization-tools/?v=1743601323" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=OS Synchronization Tools - Develiberta&u=https://develiberta.github.io/posts/os-synchronization-tools/?v=1743601323" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=OS Synchronization Tools - Develiberta&url=https://develiberta.github.io/posts/os-synchronization-tools/?v=1743601323" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/os-definition/?v=1743601323">OS Definition</a><li><a href="/posts/os-storage-management/?v=1743601323">Storage Management</a><li><a href="/posts/os-virtual-memory/?v=1743601323">Virtual Memroy</a><li><a href="/posts/os-main-memory/?v=1743601323">Main Memroy</a><li><a href="/posts/os-deadlocks/?v=1743601323">Deadlocks</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cs/?v=1743601323">CS</a> <a class="post-tag" href="/tags/os/?v=1743601323">OS</a> <a class="post-tag" href="/tags/securiy/?v=1743601323">Securiy</a> <a class="post-tag" href="/tags/ansible/?v=1743601323">Ansible</a> <a class="post-tag" href="/tags/devops/?v=1743601323">DevOps</a> <a class="post-tag" href="/tags/linux/?v=1743601323">Linux</a> <a class="post-tag" href="/tags/typography/?v=1743601323">typography</a> <a class="post-tag" href="/tags/algorithm/?v=1743601323">Algorithm</a> <a class="post-tag" href="/tags/favicon/?v=1743601323">favicon</a> <a class="post-tag" href="/tags/getting-started/?v=1743601323">getting started</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/os-thread-02/?v=1743601323"><div class="card-body"> <span class="timeago small" >Oct 23, 2022<i class="unloaded">2022-10-23T13:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OS Thread (2)</h3><div class="text-muted small"><p> 목적 CPU 이용의 기본 단위가 된 스레드를 이해한다. 실천 목표 스레드 풀, 포크 조인 및 그랜드 센트럴 디스패치를 포함하여 암시적 스레딩에 대한 다양한 접근 방식을 설명한다. Windows 및 Linux 운영체제가 스레드를 어떻게 나타내는지 설명한다. Pthread, Java 및 Windows 스레딩 API를 사용하여 ...</p></div></div></a></div><div class="card"> <a href="/posts/os-cpu-scheduling-01/?v=1743601323"><div class="card-body"> <span class="timeago small" >Oct 29, 2022<i class="unloaded">2022-10-29T13:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OS CPU Scheduling</h3><div class="text-muted small"><p> 목적 CPU 이용의 기본 단위가 된 스레드를 이해한다. 실천 목표 다양한 CPU 스케줄링 알고리즘을 설명한다. 스케줄링 기준에 따라 CPU 스케줄링 알고리즘을 평가한다. 한정된 CPU (코어) 자원과 수많은 프로세스(및 스레드) 한정된 CPU (코어)를 효율적으로 할당하기 위한 스케줄링 필요 기본적인 개념 정리...</p></div></div></a></div><div class="card"> <a href="/posts/os-synchronization-examples/?v=1743601323"><div class="card-body"> <span class="timeago small" >Dec 25, 2022<i class="unloaded">2022-12-25T18:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OS Synchronization Examples</h3><div class="text-muted small"><p> 목적 동기화 예제들을 이해한다. 실천 목표 유한 버퍼, readers-writer 및 식사하는 철학자 동기화 문제에 관해 설명한다. 동시성 제어 문제의 분류 유한 버퍼 문제 The Bounded Buffer Problem Readers-Writers 문제 The Readers-Writers Problem 식사하는 철...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/os-cpu-scheduling-01/?v=1743601323" class="btn btn-outline-primary" prompt="Older"><p>OS CPU Scheduling</p></a> <a href="/posts/os-synchronization-examples/?v=1743601323" class="btn btn-outline-primary" prompt="Newer"><p>OS Synchronization Examples</p></a></div><script src="https://utteranc.es/client.js" repo="develiberta/blog-comments" issue-term="url" theme="github-light" crossorigin="anonymous" async> </script> <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/develiberta">develiberta</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/cs/?v=1743601323">CS</a> <a class="post-tag" href="/tags/os/?v=1743601323">OS</a> <a class="post-tag" href="/tags/securiy/?v=1743601323">Securiy</a> <a class="post-tag" href="/tags/ansible/?v=1743601323">Ansible</a> <a class="post-tag" href="/tags/devops/?v=1743601323">DevOps</a> <a class="post-tag" href="/tags/linux/?v=1743601323">Linux</a> <a class="post-tag" href="/tags/typography/?v=1743601323">typography</a> <a class="post-tag" href="/tags/algorithm/?v=1743601323">Algorithm</a> <a class="post-tag" href="/tags/favicon/?v=1743601323">favicon</a> <a class="post-tag" href="/tags/getting-started/?v=1743601323">getting started</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://develiberta.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js?v=1743601323"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js?v=1743601323"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
